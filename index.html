<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood Melody - Indian Music Recommender</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple spinner animation */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #fff;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen p-4">

    <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-lg mx-auto">
        <!-- Header -->
        <div class="text-center">
            <h1 class="text-3xl font-bold mb-2">Mood Melody</h1>
            <p class="text-gray-400 mb-6">Select your mood for a curated Indian playlist.</p>
        </div>

        <!-- Mood Selection Buttons -->
        <div class="grid grid-cols-2 sm:grid-cols-3 gap-4 mb-8">
            <button data-mood="happy" class="mood-btn bg-yellow-500 hover:bg-yellow-600 focus:ring-yellow-400">üòä Happy</button>
            <button data-mood="sad" class="mood-btn bg-blue-500 hover:bg-blue-600 focus:ring-blue-400">üò¢ Sad</button>
            <button data-mood="energetic" class="mood-btn bg-red-500 hover:bg-red-600 focus:ring-red-400">‚ö° Energetic</button>
            <button data-mood="calm" class="mood-btn bg-green-500 hover:bg-green-600 focus:ring-green-400">üßò Calm</button>
            <button data-mood="romantic" class="mood-btn bg-pink-500 hover:bg-pink-600 focus:ring-pink-400">‚ù§Ô∏è Romantic</button>
            <button data-mood="workout" class="mood-btn bg-orange-500 hover:bg-orange-600 focus:ring-orange-400">üí™ Workout</button>
        </div>

        <!-- Recommendations Section -->
        <div id="recommendations" class="hidden">
            <!-- Curated Playlist -->
            <h2 class="text-2xl font-semibold mb-4 border-t border-gray-700 pt-6">Editor's Picks</h2>
            <div id="song-list" class="space-y-3 text-left max-h-60 overflow-y-auto pr-2">
                <!-- Curated song items will be injected here -->
            </div>
            
            <!-- API Generation Button -->
            <div class="text-center mt-6">
                 <button id="generate-more" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-purple-400 focus:ring-opacity-50 flex items-center justify-center w-full sm:w-auto mx-auto disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg id="sparkle-icon" class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.293 2.293a1 1 0 010 1.414L10 16l-4 4 4-4 5.293 5.293a1 1 0 001.414 0L21 18m-5-5l2.293-2.293a1 1 0 000-1.414L16 7l-4 4 4 4z"></path></svg>
                    <span id="generate-text">Generate Fresh Playlist</span>
                    <div id="spinner" class="spinner hidden ml-2"></div>
                </button>
            </div>

             <!-- API Generated Playlist -->
            <div id="api-results" class="hidden mt-6">
                <h2 class="text-2xl font-semibold mb-4 border-t border-gray-700 pt-6">Freshly Generated For You</h2>
                <div id="api-song-list" class="space-y-3 text-left max-h-60 overflow-y-auto pr-2">
                    <!-- API song items will be injected here -->
                </div>
            </div>
        </div>
    </div>

    <style>
        .mood-btn {
            padding: 12px;
            border-radius: 12px;
            font-weight: 600;
            color: white;
            transition: all 0.2s ease-in-out;
            transform: scale(1);
            outline: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
        }
        .mood-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.2);
        }
        .mood-btn:focus {
            ring-4 ring-opacity-50;
        }
    </style>

    <script>
        // --- DATA ---
        const songDatabase = {
            happy: [
                { title: "Gallan Goodiyaan", artist: "Yashita Sharma, Manish Kumar Tipu" },
                { title: "Mauja Hi Mauja", artist: "Mika Singh" },
                { title: "Badtameez Dil", artist: "Benny Dayal, Shefali Alvares" },
                { title: "Kar Gayi Chull", artist: "Badshah, Fazilpuria, Sukriti Kakar, Neha Kakkar" },
                { title: "London Thumakda", artist: "Labh Janjua, Sonu Kakkar, Neha Kakkar" },
                { title: "Ghungroo", artist: "Arijit Singh, Shilpa Rao" },
                { title: "Dil Dhadakne Do", artist: "Priyanka Chopra, Farhan Akhtar" },
            ],
            sad: [
                { title: "Tujhe Bhula Diya", artist: "Mohit Chauhan, Shekhar Ravjiani, Shruti Pathak" },
                { title: "Kabira", artist: "Tochi Raina, Rekha Bhardwaj" },
                { title: "Channa Mereya", artist: "Arijit Singh" },
                { title: "Agar Tum Saath Ho", artist: "Alka Yagnik, Arijit Singh" },
                { title: "Jag Soona Soona Lage", artist: "Rahat Fateh Ali Khan, Richa Sharma" },
                { title: "Maai Teri Chunariya", artist: "Arijit Singh" },
                { title: "Tadap Tadap Ke", artist: "KK, Dominique Cerejo" },
            ],
            energetic: [
                { title: "Malhari", artist: "Vishal Dadlani" },
                { title: "Zinda", artist: "Siddharth Mahadevan" },
                { title: "Chak De! India", artist: "Sukhwinder Singh, Salim-Sulaiman" },
                { title: "Dangal", artist: "Daler Mehndi" },
                { title: "Jai Ho", artist: "A. R. Rahman, Sukhwinder Singh" },
                { title: "India Waale", artist: "Vishal Dadlani, K.K., Shankar Mahadevan, Neeti Mohan" },
                { title: "Rang De Basanti", artist: "Daler Mehndi, K. S. Chithra" },
            ],
            calm: [
                { title: "Iktara", artist: "Kavita Seth, Amitabh Bhattacharya" },
                { title: "Sham", artist: "Amit Trivedi, Nikhil D'Souza" },
                { title: "Kun Faya Kun", artist: "A. R. Rahman, Javed Ali, Mohit Chauhan" },
                { title: "Moh Moh Ke Dhaage", artist: "Papon, Monali Thakur" },
                { title: "Tu Hi Re", artist: "Hariharan, Kavita Krishnamurthy" },
                { title: "O Saathi Re", artist: "Arijit Singh" },
                { title: "Soch Na Sake", artist: "Arijit Singh, Tulsi Kumar" },
            ],
            romantic: [
                { title: "Tujh Mein Rab Dikhta Hai", artist: "Roop Kumar Rathod" },
                { title: "Tum Se Hi", artist: "Mohit Chauhan" },
                { title: "Pehla Nasha", artist: "Udit Narayan, Sadhana Sargam" },
                { title: "Raabta", artist: "Arijit Singh" },
                { title: "Gerua", artist: "Arijit Singh, Antara Mitra" },
                { title: "Tum Hi Ho", artist: "Arijit Singh" },
                { title: "Zara Zara", artist: "Bombay Jayashri" },
            ],
            workout: [
                { title: "Sultan (Title Track)", artist: "Sukhwinder Singh, Shadab Faridi" },
                { title: "Bhaag Milkha Bhaag", artist: "Arif Lohar" },
                { title: "Ziddi Dil", artist: "Vishal Dadlani" },
                { title: "Brothers Anthem", artist: "Ajay-Atul, Vishal Dadlani" },
                { title: "Dhaakad", artist: "Raftaar" },
                { title: "Apna Time Aayega", artist: "Ranveer Singh, Divine" },
                { title: "Get Ready To Fight", artist: "Benny Dayal, Siddharth Basrur" }
            ]
        };
        
        // --- DOM ELEMENTS ---
        const moodButtons = document.querySelectorAll('.mood-btn');
        const recommendationsDiv = document.getElementById('recommendations');
        const songListDiv = document.getElementById('song-list');
        const generateMoreBtn = document.getElementById('generate-more');
        const apiResultsDiv = document.getElementById('api-results');
        const apiSongListDiv = document.getElementById('api-song-list');
        const spinner = document.getElementById('spinner');
        const generateText = document.getElementById('generate-text');
        
        let currentMood = '';

        // --- FUNCTIONS ---
        
        /**
         * Renders a list of songs into a specified container.
         * @param {Array<Object>} songs - Array of song objects {title, artist}.
         * @param {HTMLElement} container - The DOM element to render into.
         */
        function renderSongs(songs, container) {
            container.innerHTML = ''; // Clear previous list
            if (songs && songs.length > 0) {
                songs.forEach(song => {
                    const songElement = document.createElement('div');
                    songElement.className = 'bg-gray-700 p-4 rounded-lg flex items-center shadow-md transition-transform transform hover:scale-105';
                    const icon = `<svg class="w-6 h-6 mr-4 text-gray-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2z"></path></svg>`;
                    songElement.innerHTML = `
                        ${icon}
                        <div>
                            <p class="font-semibold text-white">${song.title}</p>
                            <p class="text-sm text-gray-400">${song.artist}</p>
                        </div>`;
                    container.appendChild(songElement);
                });
            } else {
                container.innerHTML = '<p class="text-gray-400 text-center">No songs found.</p>';
            }
        }

        /**
         * Fetches song recommendations from the Gemini API.
         * @param {string} mood - The mood to get recommendations for.
         */
        async function getRecommendationsFromAPI(mood) {
            // UI updates for loading state
            generateMoreBtn.disabled = true;
            spinner.classList.remove('hidden');
            generateText.textContent = 'Generating...';
            apiResultsDiv.classList.add('hidden');

            const apiKey = "AIzaSyAsHfa9asEQ_D5KjWZAWIIgjlcrT2j2cEc"; // API key will be injected by the environment.
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            
            const prompt = `Provide a list of 10 Indian songs for a "${mood}" mood. The songs can be from Bollywood or other Indian genres. Format the response as a JSON array where each object has a "title" and "artist" key.`;

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "ARRAY",
                        items: {
                            type: "OBJECT",
                            properties: {
                                "title": { "type": "STRING" },
                                "artist": { "type": "STRING" }
                            },
                             "required": ["title", "artist"]
                        }
                    }
                }
            };
            
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API error! status: ${response.status}`);
                }

                const result = await response.json();
                
                if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                    const jsonText = result.candidates[0].content.parts[0].text;
                    const songs = JSON.parse(jsonText);
                    renderSongs(songs, apiSongListDiv);
                    apiResultsDiv.classList.remove('hidden');
                } else {
                    throw new Error("Invalid response structure from API.");
                }

            } catch (error) {
                console.error("Failed to fetch from Gemini API:", error);
                apiSongListDiv.innerHTML = `<p class="text-red-400 text-center">Could not generate songs. Please try again later.</p>`;
                apiResultsDiv.classList.remove('hidden');
            } finally {
                // Restore button state
                generateMoreBtn.disabled = false;
                spinner.classList.add('hidden');
                generateText.textContent = 'Generate Fresh Playlist';
            }
        }

        // --- EVENT LISTENERS ---
        moodButtons.forEach(button => {
            button.addEventListener('click', () => {
                currentMood = button.dataset.mood;
                const songs = songDatabase[currentMood];
                
                // Render the curated list
                renderSongs(songs, songListDiv);
                
                // Show the recommendations section and hide API results from previous selections
                recommendationsDiv.classList.remove('hidden');
                apiResultsDiv.classList.add('hidden');
                apiSongListDiv.innerHTML = '';
            });
        });
        
        generateMoreBtn.addEventListener('click', () => {
            if (currentMood) {
                getRecommendationsFromAPI(currentMood);
            }
        });

    </script>

</body>
</html>

